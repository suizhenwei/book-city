"use strict";require(["rem","jquery","swiper","lazyload","text!template/index.html","text!template/block_list.html","text!template/time-free.html","temp","text!template/recommend-list.html","text!template/dl-list.html","text!template/selflist.html"],function(t,n,a,e,i,l,s,c,d,r,o){var m=0;function f(t,a){var e=5*t,i=5*t+5,o=a.slice(e,i);return o.map(function(t,a){t.count=a+1}),o}n(".header span").on("click",function(){m=n(this).index(),n(".header span").eq(m).addClass("active").siblings().removeClass("active"),n(".content").css({transform:"translate(-"+100*m+"%)"})}),n.ajax({url:"/api/index",dataType:"json",success:function(o){c(i,o.items[0].data,".top-list"),n(".list").appendTo(".top-list"),new a(".swiper-container",{autoplay:!0,loop:!0,delay:5e3,pagination:{el:".swiper-pagination",clickable:!0}}),c(l,o.items[1],".content-hot"),o.items[5].data.data.map(function(t){t.title=t.data.title,t.cover=t.data.cover,t.fiction_id=t.data.fiction_id}),c(s,o.items[5],".timefree");c(d,f(0,o.items[2].data.data),".recommend-cont"),c(r,f(0,o.items[3].data.data),".gril-cont"),c(r,f(0,o.items[4].data.data),".boy-cont"),c(n(".text").html(),o.items[6],".sift-list-footer"),n("img.lazy").lazyload({effect:"fadeIn",container:n(".book-city")}),h(".book-city"),n(".change-btn").on("click",function(){var t=1*n(this).data("id"),a=n(this).attr("data"),e=o.items[a];t++,t%=e.data.count/5;var i=2==a?d:r;n(this).data("id",t),c(i,f(t,e.data.data),"."+n(this).prev().attr("class"))})}}),n.ajax({url:"/api/bookself",dataType:"json",success:function(t){c(o,t.items,".book-self-cont>div"),n("img.lazy").lazyload({effect:"fadeIn",container:n(".book-self")}),n(".book-self-btn").on("click",function(){n(this).toggleClass("active"),n(this).hasClass("active")?c(o,t.items,".book-self-cont>div"):c(r,t.items,".book-self-cont>div"),n("img.lazy").lazyload({effect:"fadeIn",container:n(".book-self")})})}});var p=0;function h(t){if(3<=p)return n(".loading").html("暂无更多数据"),!1;var e=n(t).height();n(t).on("scroll",function(){var t,a=n(this).children().height()-e;n(this).scrollTop()+40>=a&&(n(this).off("scroll"),t=++p,n.ajax({url:"/api/loadmore",data:{pagenum:t,limit:20},dataType:"json",success:function(t){c(r,t.items,".load-cont-list",1),h(".book-city"),n("img.lazy").lazyload({effect:"fadeIn",container:n(".book-city")})}}))})}});